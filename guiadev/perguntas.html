<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guia Interativo de Entrevistas para Desenvolvedores com IA</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Calm Harmony (Warm Neutrals with Muted Teal Accent) -->
    <!-- Application Structure Plan: A filter-driven, single-page application. The core design uses two sets of button-based filters (Seniority and Technology) to allow users to instantly customize the content view. This task-oriented structure is superior to the report's linear format because it directly addresses the user's primary goal: finding questions relevant to their specific career stage and stack. The main view is split into two parts: a dynamic radar chart visualizing the shift in skill focus across seniority levels, and a card-based layout that presents the detailed questions. This architecture transforms the static document into a personalized, exploratory tool. Gemini API features are added to each question card and a new section for interview simulation, enhancing the learning experience. -->
    <!-- Visualization & Content Choices: Report Info: Evolution of interview focus by seniority. -> Goal: Provide a quick, visual summary of changing expectations. -> Viz/Presentation Method: Radar Chart. -> Interaction: Chart updates dynamically when the user clicks a seniority filter. -> Justification: A radar chart is ideal for comparing multiple quantitative variables (skill focus areas) for different categories (seniority levels), making the trend instantly understandable. -> Library/Method: Chart.js. Report Info: Specific interview questions for each seniority/stack. -> Goal: Present detailed questions in a digestible, scannable format. -> Viz/Presentation Method: Card-based layout with integrated Gemini API buttons. -> Interaction: Cards are dynamically generated. Buttons trigger API calls for model answers, interview simulation, and TTS. -> Justification: Cards break down dense information. AI features provide deep, interactive learning opportunities. -> Library/Method: Vanilla JS DOM manipulation, Gemini API, Tailwind CSS. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* slate-50 */
        }
        .active-seniority {
            background-color: #0d9488 !important; /* teal-600 */
            color: white !important;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        .active-stack {
            background-color: #1e293b; /* slate-800 */
            color: white !important;
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -2px rgb(0 0 0 / 0.1);
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
            height: 320px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 50;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
        }
        .modal-overlay.visible {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 1rem;
            max-width: 90%;
            width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            transform: scale(0.95);
            transition: transform 0.3s;
        }
        .modal-overlay.visible .modal-content {
            transform: scale(1);
        }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #0d9488;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="text-slate-700">

    <div class="container mx-auto p-4 md:p-8">
        
        <header class="text-center mb-8 md:mb-12">
            <h1 class="text-3xl md:text-5xl font-bold text-slate-800 mb-2">Guia Interativo de Entrevistas para Devs</h1>
            <p class="text-md md:text-lg text-slate-500 max-w-3xl mx-auto">Uma análise das perguntas mais comuns, agora com o poder da IA. Use os filtros, gere respostas modelo e simule entrevistas para se preparar.</p>
        </header>

        <main>
            <section id="filters" class="mb-8 md:mb-12">
                <div class="mb-6">
                    <h2 class="text-xl font-semibold text-center text-slate-700 mb-4">Selecione o Nível de Senioridade</h2>
                    <div id="seniority-filters" class="flex flex-wrap justify-center gap-2 md:gap-4"></div>
                </div>
                <div>
                    <h2 class="text-xl font-semibold text-center text-slate-700 mb-4">Selecione a Tecnologia ou Área</h2>
                    <div id="stack-filters" class="flex flex-wrap justify-center gap-2 md:gap-3"></div>
                </div>
            </section>

            <div class="w-full bg-white p-4 md:p-8 rounded-2xl shadow-lg border border-slate-200">
                <div id="content-area" class="grid grid-cols-1 lg:grid-cols-5 gap-8 items-start">
                    
                    <div class="lg:col-span-2">
                        <div class="sticky top-8">
                            <h3 id="chart-title" class="text-xl md:text-2xl font-bold text-slate-800 mb-4 text-center">Foco da Entrevista por Senioridade</h3>
                            <p id="chart-intro" class="text-sm text-slate-500 text-center mb-4">Este gráfico ilustra como as expectativas mudam. Para um estagiário, o foco é em **Fundamentos** e **Potencial**. Para um sênior, a **Arquitetura** e a **Liderança** se tornam cruciais. Selecione um nível de senioridade para ver a mudança de foco.</p>
                            <div class="chart-container">
                                <canvas id="seniorityChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <div id="questions-section" class="lg:col-span-3">
                        <div class="flex justify-between items-center mb-6">
                            <div>
                                <h3 id="questions-title" class="text-2xl md:text-3xl font-bold text-slate-800 mb-2"></h3>
                                <p id="questions-intro" class="text-slate-600"></p>
                            </div>
                            <button id="simulate-interview-btn" class="bg-teal-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-teal-700 transition-colors shadow-md">✨ Simular Entrevista</button>
                        </div>
                        <div id="questions-container" class="space-y-4"></div>
                    </div>
                </div>
            </div>
        </main>

        <footer class="text-center mt-12 text-slate-400 text-sm">
            <p>Conteúdo adaptado do "Guia Definitivo para Entrevistas de Desenvolvedores".</p>
            <p>Aplicação interativa gerada para facilitar a exploração e o estudo, com recursos da API do Gemini.</p>
        </footer>

    </div>

    <div id="modal" class="modal-overlay">
        <div class="modal-content">
            <h3 id="modal-title" class="text-2xl font-bold text-slate-800 mb-4"></h3>
            <div id="modal-body"></div>
            <button id="modal-close" class="mt-6 bg-slate-200 text-slate-800 font-bold py-2 px-4 rounded-lg hover:bg-slate-300 transition-colors w-full">Fechar</button>
        </div>
    </div>

    <script>
        const interviewData = {
            seniorityLevels: ['Estagiário', 'Júnior', 'Pleno', 'Sênior'],
            stacks: ['Java', 'JavaScript/React', 'Node.js', 'Python', 'C#/.NET', 'Mobile', 'Full-Stack', 'Design de Sistemas'],
            chartData: {
                labels: ['Fundamentos', 'Ferramentas e Frameworks', 'Qualidade e Testes', 'Design e Arquitetura', 'Performance e Escala', 'Liderança e Estratégia'],
                datasets: {
                    'Estagiário': [5, 2, 1, 1, 1, 1],
                    'Júnior': [4, 4, 3, 2, 2, 1],
                    'Pleno': [3, 5, 4, 4, 3, 2],
                    'Sênior': [3, 4, 4, 5, 5, 5],
                }
            },
            questions: {
                'Estagiário': {
                    'Geral': {
                        intro: 'Para estagiários, o foco é avaliar o potencial, a paixão por aprender e os conhecimentos teóricos fundamentais da ciência da computação.',
                        categories: [
                            { title: 'Motivação e Objetivos', goal: 'Medir o interesse genuíno e o alinhamento com a empresa.', items: ['Por que você se interessou por esta vaga/empresa?', 'Quais são seus objetivos de carreira?', 'O que te atrai na área de desenvolvimento de software?', 'Onde você se vê em 5 anos?'] },
                            { title: 'Conceitos Fundamentais de CC', goal: 'Confirmar a base teórica necessária para construir conhecimento prático.', items: ['Qual a diferença entre SQL e NoSQL?', 'Explique o conceito de herança em Programação Orientada a Objetos.', 'Qual a diferença entre um array e uma lista encadeada?', 'O que é uma API?', 'Explique a diferença entre HTTP e HTTPS.', 'O que é um processo e o que é uma thread?'] },
                            { title: 'Projetos e Aprendizado', goal: 'Demonstrar paixão e iniciativa além das obrigações curriculares.', items: ['Fale sobre um projeto acadêmico ou pessoal em que você trabalhou.', 'Como você se mantém atualizado com as novas tecnologias?', 'Qual foi o maior desafio técnico que você enfrentou em um projeto e como o superou?', 'Se pudesse refazer um projeto, o que faria de diferente?'] },
                            { title: 'Resolução de Problemas', goal: 'Observar o processo de pensamento, a articulação de ideias e a familiaridade com a sintaxe básica.', items: ['Desafio de código simples, como inverter uma string.', 'Como você testa seu código para garantir que ele funciona?', 'O que você faz quando encontra um problema que não sabe resolver?', 'Escreva uma função que verifique se um número é primo.'] }
                        ]
                    }
                },
                'Júnior': {
                    'Java': {
                        intro: 'Para um dev Java Júnior, a entrevista valida a aplicação dos fundamentos da linguagem e a compreensão conceitual do ecossistema Spring.',
                        categories: [
                            { title: 'Linguagem Principal (Core Java)', goal: 'Avaliar a profundidade do conhecimento, da sintaxe básica aos mecanismos internos da JVM.', items: ['Qual a diferença entre `==` e `.equals()` para Strings?', 'Explique JVM, JRE e JDK.', 'Qual a diferença entre `ArrayList` e `LinkedList`?', 'O que são tipos genéricos (Generics)?', 'Explique a diferença entre exceções checadas e não checadas.', 'O que é a palavra-chave `final` e onde ela pode ser usada?'] },
                            { title: 'Framework (Spring)', goal: 'Medir a compreensão do framework, desde o uso conceitual.', items: ['Quais são os benefícios de usar o Spring Boot em um projeto?', 'O que é o Spring Data e quais suas vantagens?', 'O que é o Spring MVC?', 'Como o Spring lida com transações (@Transactional)?', 'O que é uma anotação no Spring e dê exemplos.'] },
                            { title: 'Bancos de Dados', goal: 'Verificar a capacidade de interagir com dados.', items: ['O que um `INNER JOIN` faz em SQL?', 'Explique o que é uma chave primária.', 'O que é um índice em um banco de dados e por que é útil?', 'Explique os diferentes tipos de JOINs (LEFT, RIGHT, FULL).'] },
                            { title: 'Habilidades Práticas', goal: 'Sondar o conhecimento do ciclo de vida do software.', items: ['O que você sabe sobre o uso do Git (commit, clone, merge)?', 'Como você aborda a depuração (debugging) de um problema no seu código?', 'O que é um "pull request" e qual o seu propósito?', 'Qual a importância de escrever mensagens de commit claras?'] }
                        ]
                    },
                    'JavaScript/React': {
                        intro: 'Para um dev JavaScript/React Júnior, o essencial é demonstrar um entendimento sólido dos fundamentos do JavaScript e dos conceitos básicos do React.',
                        categories: [
                            { title: 'Linguagem (JS/TS)', goal: 'Avaliar o domínio da linguagem, desde a sintaxe assíncrona.', items: ['Qual a diferença entre `Promise` e `async/await`?', 'O que são `Closures`?', 'Qual a diferença entre `map` e `forEach`?', 'O que é o "event bubbling"?', 'Explique a diferença entre `null` e `undefined`.', 'Qual a diferença entre `let`, `const` e `var`?'] },
                            { title: 'Framework (React)', goal: 'Medir o conhecimento do React, desde seus conceitos básicos.', items: ['O que é a diferença entre `state` e `props`?', 'O que é JSX?', 'Como você passa dados de um componente pai para um filho?', 'O que são "keys" em listas do React e por que são importantes?', 'Descreva o ciclo de vida de um componente de classe (legacy).'] },
                            { title: 'HTML/CSS', goal: 'Verificar a base de conhecimento para construção de interfaces.', items: ['O que é o "box model" no CSS?', 'Como você tornaria um site responsivo para dispositivos móveis?', 'Qual a diferença entre `display: none;` e `visibility: hidden;`?', 'O que são seletores CSS e qual a sua especificidade?'] },
                            { title: 'Ecossistema e Testes', goal: 'Sondar a familiaridade com as ferramentas do ecossistema.', items: ['O que é o NPM?', 'Qual a importância de escrever testes?', 'O que é um linter (como o ESLint) e por que usá-lo?', 'Para que serve o arquivo `package-lock.json`?'] }
                        ]
                    },
                    'Node.js': {
                        intro: 'Para um dev Node.js Júnior, o foco é validar a compreensão dos conceitos fundamentais do Node, especialmente seu modelo assíncrono.',
                        categories: [
                            { title: 'Paradigma Central', goal: 'Avaliar a profundidade do entendimento do modelo de E/S não bloqueante.', items: ['O que é o loop de eventos (event loop) no Node.js?', 'O que significa dizer que o Node.js é "non-blocking"?', 'O que é o módulo `fs` e para que serve?'] },
                            { title: 'Programação Assíncrona', goal: 'Medir a maturidade no tratamento da assincronicidade.', items: ['O que é "callback hell" e como `Promises` ajudam a resolvê-lo?', 'Qual a diferença entre `Promises` e `async/await`?', 'Como você lê um arquivo de forma assíncrona no Node.js?'] },
                            { title: 'Frameworks e APIs', goal: 'Verificar a capacidade de construir aplicações web.', items: ['Como você cria um servidor "Hello World" básico com Express.js?', 'O que é uma rota em uma aplicação Express?', 'Como você lida com os parâmetros de uma requisição (query, params, body)?'] },
                            { title: 'Ecossistema', goal: 'Sondar a familiaridade com as ferramentas e as melhores práticas.', items: ['O que é o NPM e para que serve o arquivo `package.json`?', 'Qual a finalidade do `nodemon`?', 'Como você gerencia variáveis de ambiente em uma aplicação Node.js?'] }
                        ]
                    },
                     'Python': {
                        intro: 'Para um dev Python Júnior, o foco é a proficiência nos fundamentos da linguagem e a familiaridade com suas estruturas de dados principais.',
                        categories: [
                            { title: 'Fundamentos da Linguagem', goal: 'Avaliar o domínio da linguagem, desde suas estruturas de dados básicas.', items: ['Explique a diferença entre listas e tuplas em Python.', 'Como funcionam os dicionários?', 'O que é fatiamento (slicing) de sequências?', 'O que são "list comprehensions"?', 'Qual a diferença entre `range` e `xrange` (Python 2)?'] },
                            { title: 'Conceitos Gerais', goal: 'Verificar o entendimento de conceitos básicos do ecossistema.', items: ['O que é o PEP 8?', 'Python é uma linguagem compilada ou interpretada?', 'O que são módulos e pacotes em Python?', 'Como você lida com o tratamento de exceções (try/except)?'] },
                            { title: 'Frameworks Web', goal: 'Medir a experiência com frameworks web.', items: ['O que é um ORM (Object-Relational Mapping)?', 'Você tem experiência com Django ou Flask?', 'O que é um template engine?', 'Como você define uma rota em Flask?'] },
                            { title: 'Comunicação', goal: 'Analisar a compreensão de como sistemas se conectam.', items: ['Como o back-end se comunica com o front-end?', 'O que é JSON e por que é comumente usado em APIs?', 'O que é um verbo HTTP (GET, POST, etc.)?'] }
                        ]
                    },
                    'C#/.NET': {
                        intro: 'Para um dev C#/.NET Júnior, o objetivo é validar o conhecimento dos conceitos básicos de C# e da plataforma .NET.',
                        categories: [
                            { title: 'Linguagem (C#)', goal: 'Avaliar o domínio da linguagem C#, desde seus tipos fundamentais.', items: ['Qual a diferença entre `struct` (tipo de valor) e `class` (tipo de referência)?', 'O que é `boxing` e `unboxing`?', 'Explique os 4 pilares da OOP.', 'O que é uma propriedade em C#?', 'Para que serve a palavra-chave `static`?'] },
                            { title: 'Plataforma .NET', goal: 'Medir a profundidade do conhecimento sobre a plataforma .NET.', items: ['Qual a diferença entre .NET Core e .NET Framework?', 'O que é o CLR?', 'O que é o MSIL (ou CIL)?', 'O que é o NuGet?'] },
                            { title: 'Framework Web (ASP.NET)', goal: 'Verificar a capacidade de construir aplicações web.', items: ['O que é o padrão MVC?', 'O que são Razor Pages?', 'Como funciona o roteamento no ASP.NET Core?', 'O que é o `Startup.cs`?'] },
                            { title: 'Acesso a Dados', goal: 'Analisar a habilidade de interagir com bancos de dados.', items: ['O que é LINQ?', 'O que é o ADO.NET?', 'Como você se conectaria a um banco de dados SQL Server?', 'O que é uma string de conexão?'] }
                        ]
                    },
                    'Mobile': {
                        intro: 'Para um dev Mobile Júnior, o foco está nos fundamentos da linguagem (Swift ou Kotlin) e nos componentes básicos de UI da plataforma.',
                        categories: [
                            { title: 'Fundamentos da Linguagem (Swift)', goal: 'Validar o conhecimento dos recursos idiomáticos e de segurança.', items: ['Qual a diferença entre `struct` e `class` em Swift?', 'O que são `Optionals` e como lidar com eles (optional binding, optional chaining)?', 'O que são `closures`?', 'Qual a diferença entre `let` e `var`?'] },
                            { title: 'Fundamentos da Linguagem (Kotlin)', goal: 'Validar o conhecimento dos recursos idiomáticos e de segurança.', items: ['Como o Kotlin lida com a `null safety`?', 'O que são `data classes`?', 'O que são `extension functions`?', 'Qual a diferença entre `val` e `var`?'] },
                            { title: 'Ciclo de Vida e UI', goal: 'Avaliar a compreensão dos componentes da plataforma.', items: ['Descreva o ciclo de vida de uma Activity (Android) ou ViewController (iOS).', 'Como você exibiria uma lista de itens na tela (UITableView/UICollectionView ou RecyclerView)?', 'O que é o Auto Layout (iOS) ou ConstraintLayout (Android)?'] },
                            { title: 'Gerenciamento de Memória', goal: 'Verificar o entendimento de conceitos básicos de memória.', items: ['O que é ARC em Swift? (Conceito básico)', 'O que é um ciclo de retenção forte (strong reference cycle)?', 'Como o Garbage Collector funciona no Android?'] }
                        ]
                    },
                },
                'Pleno': {
                    'Java': {
                        intro: 'Para o nível Pleno, as expectativas se aprofundam, exigindo conhecimento sobre os mecanismos internos do Java e um domínio mais prático do Spring.',
                        categories: [
                            { title: 'Linguagem Principal (Core Java)', goal: 'Avaliar a profundidade do conhecimento.', items: ['Explique o conceito de Reflection e como o Garbage Collector funciona.', 'O que são `Annotations`?', 'Qual a diferença entre `HashMap`, `Hashtable` e `ConcurrentHashMap`?', 'O que são `streams` no Java 8 e quais suas vantagens?'] },
                            { title: 'Framework (Spring)', goal: 'Medir a compreensão do framework.', items: ['Explique como funciona o contêiner de Inversão de Controle (IoC) do Spring.', 'O que é Injeção de Dependência (DI)?', 'Qual a diferença entre as anotações `@Component`, `@Service`, `@Repository` e `@Controller`?', 'O que é o Spring AOP (Aspect-Oriented Programming)?'] },
                            { title: 'Bancos de Dados', goal: 'Verificar a capacidade de interagir com dados.', items: ['Qual a diferença entre SQL e NoSQL e quando usar cada um?', 'O que é o problema N+1 em ORMs e como resolvê-lo?', 'Explique os níveis de isolamento de transação em bancos de dados.'] },
                            { title: 'Arquitetura e Design', goal: 'Analisar a capacidade de projetar software.', items: ['Fale sobre os princípios SOLID e dê um exemplo do Princípio da Responsabilidade Única.', 'O que são Padrões de Projeto (Design Patterns)? Cite um exemplo do padrão Singleton e Factory.', 'Qual a diferença entre acoplamento e coesão?'] },
                            { title: 'DevOps e Infraestrutura', goal: 'Sondar o conhecimento do ciclo de vida do software.', items: ['Você sabe como funciona o TDD (Test-Driven Development)?', 'O que são testes unitários e de integração?', 'O que é Docker e por que é útil no desenvolvimento Java?', 'O que é uma API RESTful e quais são suas principais características?'] }
                        ]
                    },
                    'JavaScript/React': {
                        intro: 'Para o nível Pleno, a entrevista exige uma compreensão mais profunda de como o React e o navegador funcionam, além de experiência com o ecossistema.',
                        categories: [
                            { title: 'Linguagem (JS/TS)', goal: 'Avaliar o domínio da linguagem e seus mecanismos internos.', items: ['Explique o Event Loop do JavaScript em detalhes.', 'Quando você usaria TypeScript em um projeto? Quais as vantagens?', 'O que é o `prototype` em JavaScript?', 'Como funciona o `this` em diferentes contextos (funções de seta, métodos de objeto)?'] },
                            { title: 'Framework (React)', goal: 'Medir o conhecimento do React e seu ciclo de vida.', items: ['Explique como o Virtual DOM funciona.', 'Como o hook `useEffect` gerencia o ciclo de vida de um componente? Quais são os casos de uso do seu array de dependências?', 'O que são High-Order Components (HOCs)?', 'Qual a diferença entre componentes controlados e não controlados?'] },
                            { title: 'Gerenciamento de Estado', goal: 'Verificar a habilidade de gerenciar a complexidade dos dados.', items: ['Compare o uso da Context API com o Redux para gerenciamento de estado global.', 'O que é "prop drilling" e como evitá-lo?', 'Você já usou outras bibliotecas de gerenciamento de estado como Zustand ou MobX?'] },
                            { title: 'Performance', goal: 'Analisar a conscientização sobre performance.', items: ['O que é `code splitting` e por que é importante?', 'O que é `lazy loading` de componentes?', 'Como você pode otimizar a performance de renderização de uma lista grande?', 'O que é `memoization` em React e como `React.memo` funciona?'] },
                            { title: 'Ecossistema e Testes', goal: 'Sondar a familiaridade com as ferramentas do ecossistema.', items: ['O que é Babel e como o Webpack funciona?', 'Qual a diferença entre Jest e React Testing Library?', 'Como você faria o deploy de uma aplicação React?', 'O que é o Cross-Origin Resource Sharing (CORS)?'] }
                        ]
                    },
                    'Node.js': {
                        intro: 'Para o nível Pleno, a entrevista aprofunda-se nos aspectos mais avançados da plataforma Node.js e na construção de aplicações robustas.',
                        categories: [
                            { title: 'Paradigma Central', goal: 'Avaliar a profundidade do entendimento do modelo de E/S.', items: ['Explique a diferença entre `setImmediate()`, `setTimeout()` e `process.nextTick()`.', 'O que são `Buffers` e por que são necessários no Node.js?', 'Como o Node.js lida com operações que consomem muita CPU?'] },
                            { title: 'Programação Assíncrona', goal: 'Medir a maturidade no tratamento da assincronicidade.', items: ['O que são `streams` no Node.js e por que são úteis para lidar com grandes volumes de dados?', 'Como você lida com o tratamento de erros em `Promises` encadeadas?', 'Explique o padrão `EventEmitter`.'] },
                            { title: 'Frameworks e APIs', goal: 'Verificar a capacidade de construir aplicações web.', items: ['O que é `middleware` no Express.js e qual a ordem de execução?', 'Como você estrutura o tratamento de erros em uma API Express?', 'Como você implementaria autenticação em uma API Node.js (e.g., com JWT)?'] },
                            { title: 'Escalabilidade', goal: 'Analisar a compreensão sobre como escalar aplicações.', items: ['Qual a diferença entre os métodos `fork()` e `spawn()` do módulo `child_process`?', 'O que é o módulo `cluster` e como ele pode ser usado?', 'Como você implementaria caching em uma aplicação Node.js?'] },
                            { title: 'Integração', goal: 'Verificar a experiência prática com outros serviços.', items: ['Como você se conecta e interage com um banco de dados MongoDB usando Mongoose?', 'Como você se conecta a um banco de dados relacional (e.g., PostgreSQL) a partir do Node.js?', 'Você tem experiência com filas de mensagens como RabbitMQ ou SQS?'] }
                        ]
                    },
                    'Python': {
                        intro: 'Para o nível Pleno, a entrevista exige um conhecimento mais profundo de características avançadas do Python e experiência com frameworks web.',
                        categories: [
                            { title: 'Fundamentos da Linguagem', goal: 'Avaliar o domínio de recursos avançados da linguagem.', items: ['Como funcionam os `decorators` e em que cenários você os utilizaria?', 'O que são `generators` e qual a diferença para uma função normal?', 'Qual a diferença entre `*args` e `**kwargs`?', 'Explique o que são `metaclasses` em Python.'] },
                            { title: 'Frameworks Web', goal: 'Medir a experiência com frameworks web.', items: ['Explique de forma resumida como funciona o Django (ou Flask).', 'O que são `middlewares` em Django/Flask e como você os implementaria?', 'Como o ORM do Django lida com migrações de banco de dados?', 'Como você lida com autenticação e permissões em Django Rest Framework?'] },
                            { title: 'Design de API e Arquitetura', goal: 'Verificar a capacidade de projetar e escalar sistemas.', items: ['Cite vantagens e desvantagens da Arquitetura em Microsserviços.', 'O que é uma API RESTful e quais são os princípios de design?', 'Como você versionaria uma API?'] },
                            { title: 'Boas Práticas e Ecossistema', goal: 'Sondar a adesão às melhores práticas da comunidade.', items: ['Como você lida com o gerenciamento de dependências e ambientes virtuais em Python?', 'Qual a importância de escrever testes unitários? Quais ferramentas você usa?', 'O que é o Celery e para que é usado?'] }
                        ]
                    },
                    'C#/.NET': {
                        intro: 'Para o nível Pleno, a entrevista aprofunda-se no funcionamento interno do .NET e na aplicação prática de padrões de design.',
                        categories: [
                            { title: 'Linguagem (C#)', goal: 'Avaliar o domínio da linguagem C#.', items: ['Explique a diferença entre as palavras-chave `ref` e `out`.', 'O que são `delegates` e `events`?', 'O que são métodos de extensão e como criá-los?', 'Explique a palavra-chave `yield`.'] },
                            { title: 'Plataforma .NET', goal: 'Medir a profundidade do conhecimento sobre a plataforma.', items: ['Explique o conceito de coleta de lixo (Garbage Collection) no .NET.', 'Como funciona a programação assíncrona com `async/await`?', 'O que são `Assemblies` no .NET?', 'O que é o GAC (Global Assembly Cache)?'] },
                            { title: 'Framework Web (ASP.NET)', goal: 'Verificar a capacidade de construir aplicações web.', items: ['O que é `middleware` em ASP.NET Core e como funciona o pipeline de requisições?', 'Como funciona o sistema de configuração no ASP.NET Core?', 'O que são filtros de ação (Action Filters)?'] },
                            { title: 'Acesso a Dados', goal: 'Analisar a habilidade de interagir com bancos de dados.', items: ['O que é o Entity Framework e como ele é usado para gerenciamento de banco de dados?', 'Qual a diferença entre Code-First, Database-First e Model-First?', 'O que é o problema N+1 no Entity Framework?'] },
                            { title: 'Arquitetura e Princípios', goal: 'Sondar a maturidade em design de software.', items: ['O que é injeção de dependência (DI) e por que é útil?', 'Explique os princípios SOLID.', 'O que são os padrões de projeto Repository e Unit of Work?'] }
                        ]
                    },
                     'Mobile': {
                        intro: 'Para o nível Pleno, a entrevista foca em padrões de arquitetura, gerenciamento de estado e concorrência na plataforma móvel.',
                        categories: [
                            { title: 'Arquitetura e Padrões (Swift)', goal: 'Verificar a capacidade de estruturar uma aplicação.', items: ['Discuta os padrões de projeto MVC, MVP e MVVM no contexto do iOS.', 'O que são `protocols` e como você os utiliza para delegação?', 'O que é o padrão Coordinator e que problema ele resolve?'] },
                            { title: 'Arquitetura e Padrões (Kotlin)', goal: 'Verificar a capacidade de estruturar uma aplicação.', items: ['Explique a arquitetura MVVM com componentes do Jetpack (ViewModel, LiveData).', 'O que são `sealed classes` e como podem ser usadas para modelar estados da UI?', 'O que é o padrão Repository no desenvolvimento Android?'] },
                            { title: 'Programação Assíncrona (Swift)', goal: 'Medir a habilidade de executar tarefas em segundo plano.', items: ['Explique o papel do Grand Central Dispatch (GCD) e `OperationQueues`.', 'O que é o Combine framework?', 'Como você lidaria com uma tarefa de longa duração sem congelar a UI?'] },
                            { title: 'Programação Assíncrona (Kotlin)', goal: 'Medir a habilidade de executar tarefas em segundo plano.', items: ['O que são `Coroutines` e por que são benéficas para o desenvolvimento Android?', 'Explique os escopos de corrotina (Coroutine Scopes).', 'O que é `Flow` e como se compara ao `LiveData`?'] },
                            { title: 'Gerenciamento de Dependências', goal: 'Avaliar o conhecimento sobre o ecossistema.', items: ['Você tem experiência com CocoaPods/SPM (iOS) ou Dagger/Koin (Android)?', 'Qual a diferença entre injeção de dependência manual e o uso de uma biblioteca?', 'O que é o gráfico de dependências?'] }
                        ]
                    },
                },
                'Sênior': {
                    'Java': {
                        intro: 'A entrevista sênior avalia a capacidade de projetar, escalar e manter sistemas Java complexos, além de um domínio profundo das nuances da plataforma.',
                        categories: [
                            { title: 'Linguagem Principal (Core Java)', goal: 'Avaliar a profundidade do conhecimento nos mecanismos internos.', items: ['Discuta o Java Memory Model.', 'Como você garantiria a segurança de threads (thread safety) em uma aplicação de alta concorrência?', 'Explique como funcionam os `ClassLoaders` no Java.', 'Quais são os diferentes tipos de referências em Java (Strong, Soft, Weak, Phantom)?'] },
                            { title: 'Framework (Spring)', goal: 'Medir a habilidade de estender o framework e projetar soluções arquiteturais.', items: ['Como você projetaria um starter customizado do Spring Boot para um requisito de negócio transversal (cross-cutting concern)?', 'Discuta estratégias de segurança com Spring Security (OAuth2, JWT).', 'Como funciona o auto-configuration do Spring Boot por baixo dos panos?'] },
                            { title: 'Bancos de Dados', goal: 'Verificar a capacidade de tomar decisões arquiteturais de persistência e performance.', items: ['Como você implementaria uma estratégia de cache distribuído para reduzir a carga em um banco de dados relacional?', 'Discuta estratégias de sharding de banco de dados.', 'Quando você escolheria usar um banco de dados orientado a grafos?'] },
                            { title: 'Arquitetura e Design', goal: 'Analisar a capacidade de liderar transformações arquiteturais complexas.', items: ['Como você migraria um sistema monolítico legado para uma arquitetura de microsserviços usando o padrão Strangler Fig?', 'Discuta os trade-offs de diferentes padrões de comunicação em microsserviços (REST vs. Filas de Mensagens vs. gRPC).', 'O que é Arquitetura Hexagonal (Ports and Adapters)?'] },
                            { title: 'DevOps e Infraestrutura', goal: 'Sondar o conhecimento do ciclo de vida completo do software.', items: ['Por que é importante dominar Kubernetes para um desenvolvedor Java sênior?', 'Descreva um pipeline de CI/CD para uma aplicação Java.', 'Como você implementaria monitoramento e observabilidade (logs, métricas, traces) para um sistema distribuído?'] }
                        ]
                    },
                    'JavaScript/React': {
                        intro: 'Um dev front-end sênior é avaliado por sua capacidade de liderar a arquitetura da interface, otimizar a performance e tomar decisões estratégicas.',
                        categories: [
                            { title: 'Linguagem (JS/TS)', goal: 'Avaliar a aplicação estratégica de tipagem e performance.', items: ['Como você lidaria com a segurança de tipos em um grande projeto JavaScript legado sendo migrado para TypeScript?', 'Como o garbage collection funciona em motores JavaScript como o V8?', 'Discuta as implicações de performance do uso de `async/await` em loops.'] },
                            { title: 'Framework (React)', goal: 'Medir o conhecimento em otimização de performance e decisões arquiteturais.', items: ['Discuta as vantagens e desvantagens do Server-Side Rendering (SSR) com Next.js em comparação com uma SPA tradicional.', 'Explique padrões de design como High-Order Components (HOCs) e Render Props, e quando preferir hooks customizados.', 'O que são React Server Components e que problema eles resolvem?'] },
                            { title: 'Gerenciamento de Estado', goal: 'Verificar a habilidade de projetar arquiteturas de estado globais.', items: ['Projete um sistema de gerenciamento de estado escalável para uma aplicação complexa com dados em tempo real.', 'Discuta os prós e contras de usar uma biblioteca como o GraphQL (Apollo/Relay) para gerenciamento de dados.', 'Como você sincronizaria o estado entre múltiplas abas do navegador?'] },
                            { title: 'Performance', goal: 'Analisar técnicas avançadas de otimização de renderização.', items: ['Como você usaria `React.memo`, `useMemo` e `useCallback` para otimizar uma aplicação que sofre de re-renderizações excessivas?', 'O que é `windowing` e quando é útil?', 'Como você analisaria e melhoraria as métricas de Core Web Vitals de uma aplicação?'] },
                            { title: 'Ecossistema e Testes', goal: 'Sondar a maturidade em relação à qualidade de software.', items: ['Descreva uma estratégia de testes completa para uma aplicação React, cobrindo testes unitários, de integração e end-to-end.', 'Como você garantiria a segurança contra ataques XSS em uma aplicação React?', 'O que são Micro Frontends e quando essa arquitetura faz sentido?'] }
                        ]
                    },
                    'Node.js': {
                        intro: 'Para um dev Node.js Sênior, a avaliação foca na arquitetura, escalabilidade e segurança de aplicações em produção.',
                        categories: [
                            { title: 'Paradigma Central', goal: 'Avaliar o entendimento profundo dos detalhes de implementação do Node.js.', items: ['Como o `libuv` gerencia o pool de threads para lidar com operações de E/S assíncronas?', 'Discuta as implicações de performance de diferentes tipos de `streams`.', 'Como você depuraria um problema de alto uso de CPU em uma aplicação Node.js em produção?'] },
                            { title: 'Programação Assíncrona', goal: 'Medir a maturidade na otimização de performance e memória.', items: ['Como você mediria a duração de uma operação assíncrona complexa e identificaria gargalos de performance?', 'Como você lidaria com vazamentos de memória (memory leaks) em uma aplicação Node.js de longa duração?', 'O que são `worker_threads` e quando usá-los?'] },
                            { title: 'Frameworks e APIs', goal: 'Verificar a capacidade de projetar APIs complexas e seguras.', items: ['Projete uma API RESTful para um sistema de e-commerce, incluindo autenticação, paginação e versionamento.', 'Discuta os prós e contras de usar GraphQL em vez de REST.', 'Como você implementaria rate limiting em uma API?'] },
                            { title: 'Escalabilidade', goal: 'Analisar a compreensão sobre como construir aplicações de alta performance.', items: ['Explique como você usaria o módulo `cluster` para escalar uma aplicação Node.js em uma máquina com múltiplos núcleos.', 'Qual a diferença entre usar o módulo `cluster` e um orquestrador de contêineres como Kubernetes para escalar?', 'Como você projetaria um sistema para lidar com milhões de conexões WebSocket simultâneas?'] },
                            { title: 'Segurança', goal: 'Sondar a familiaridade com as melhores práticas de segurança.', items: ['Quais são as principais vulnerabilidades de segurança em aplicações Node.js e como mitigá-las (e.g., Injeção, XSS)?', 'Como você gerencia segredos e chaves de API de forma segura em produção?', 'O que é o `npm audit` e como você lida com as vulnerabilidades reportadas?'] }
                        ]
                    },
                    'Python': {
                        intro: 'Para um dev Python Sênior, a entrevista foca em tópicos de baixo nível, arquitetura de sistemas distribuídos e otimização de performance.',
                        categories: [
                            { title: 'Fundamentos da Linguagem', goal: 'Avaliar o domínio dos mecanismos internos e recursos avançados.', items: ['Discuta o Global Interpreter Lock (GIL) e suas implicações para a execução de código multi-threaded em CPython.', 'Explique a diferença entre multithreading e multiprocessing em Python e quando usar cada um.', 'Como o gerenciamento de memória funciona em Python?', 'O que é o protocolo de descritor?'] },
                            { title: 'Frameworks Web', goal: 'Medir a experiência na arquitetura de sistemas complexos e assíncronos.', items: ['Como você gerenciaria tarefas assíncronas e filas de tarefas (e.g., Celery) em um projeto back-end Python de grande escala?', 'Discuta as vantagens e desvantagens de usar um framework assíncrono como FastAPI ou Starlette.', 'Como você implementaria `caching` em diferentes níveis de uma aplicação Django?'] },
                            { title: 'Design de API e Arquitetura', goal: 'Verificar a capacidade de projetar e escalar sistemas.', items: ['Como você abordaria a otimização de uma API RESTful em Python que está apresentando problemas de desempenho em alta carga?', 'Discuta padrões de design para microsserviços em Python.', 'Como você garantiria a idempotência de uma operação em uma API?'] },
                            { title: 'Boas Práticas e Ecossistema', goal: 'Sondar a familiaridade com técnicas avançadas para construir aplicações robustas.', items: ['Descreva uma situação em que você utilizou `caching` para melhorar a performance de uma API em Python. Quais ferramentas você utilizou?', 'Como você implementaria monitoramento e logging para uma aplicação Python em produção?', 'Qual a sua abordagem para testes em um sistema complexo?'] }
                        ]
                    },
                    'C#/.NET': {
                        intro: 'Para um dev C#/.NET Sênior, a avaliação foca na liderança da arquitetura de sistemas complexos, otimização e mentoria.',
                        categories: [
                            { title: 'Linguagem (C#)', goal: 'Avaliar o domínio das nuances da programação assíncrona e concorrência.', items: ['Qual a diferença entre `await AsyncMethod()` e `AsyncMethod().Result` e quais as implicações de cada um em termos de deadlocks?', 'O que são `Expression Trees` e como podem ser usados?', 'Discuta as melhores práticas para lidar com concorrência no C#.'] },
                            { title: 'Plataforma .NET', goal: 'Medir o conhecimento profundo do motor de execução do .NET.', items: ['Como o Common Language Runtime (CLR) gerencia a execução de código, incluindo compilação JIT e segurança de tipo?', 'Como você depuraria um vazamento de memória em uma aplicação .NET?', 'O que é AOT (Ahead-of-Time compilation) no contexto do .NET?'] },
                            { title: 'Framework Web (ASP.NET)', goal: 'Verificar a capacidade de implementar funcionalidades complexas e seguras.', items: ['Como você implementaria um sistema de autenticação e autorização robusto usando ASP.NET Core Identity?', 'Discuta diferentes tipos de `caching` no .NET (in-memory, distributed).', 'Como você implementaria uma Health Check API no ASP.NET Core?'] },
                            { title: 'Acesso a Dados', goal: 'Analisar a habilidade de otimizar a performance do ORM.', items: ['Como você otimizaria consultas do Entity Framework para evitar o problema N+1 em um cenário de alta carga?', 'Discuta estratégias de `caching` de segundo nível para o Entity Framework.', 'Quando você optaria por usar Dapper em vez do Entity Framework?'] },
                            { title: 'Liderança e Estratégia', goal: 'Sondar a capacidade de mentoria e visão de negócio.', items: ['Como você lida com o débito técnico em um projeto?', 'Como você mentoraria um desenvolvedor júnior na equipe?', 'Como você defenderia uma refatoração em larga escala para a gerência do projeto?'] }
                        ]
                    },
                     'Mobile': {
                        intro: 'Para um dev Mobile Sênior, a entrevista explora a liderança técnica, otimização de performance e decisões arquiteturais complexas.',
                        categories: [
                            { title: 'Otimização de Performance', goal: 'Avaliar a capacidade de diagnosticar e resolver gargalos.', items: ['Como você depuraria e otimizaria a performance de um aplicativo lento (e.g., usando Instruments no iOS ou Profiler no Android)?', 'Discuta estratégias para reduzir o consumo de bateria de um app.', 'Como você otimizaria o tempo de inicialização de um aplicativo?'] },
                            { title: 'Arquitetura e Design', goal: 'Verificar a habilidade de projetar sistemas móveis complexos.', items: ['Projete a arquitetura de uma camada de persistência de dados offline-first.', 'Como você gerenciaria a transição de uma grande base de código de UIKit para SwiftUI (iOS) ou de Views para Jetpack Compose (Android)?', 'Discuta os prós e contras de uma arquitetura modular em um aplicativo móvel.'] },
                            { title: 'Segurança', goal: 'Medir o conhecimento sobre como proteger dados no dispositivo.', items: ['Quais são as melhores práticas para armazenar dados sensíveis (como tokens de autenticação) de forma segura em um dispositivo móvel?', 'O que é `certificate pinning` e por que é importante?', 'Como você protegeria a comunicação de rede do seu aplicativo contra ataques man-in-the-middle?'] },
                            { title: 'CI/CD e Automação', goal: 'Sondar a experiência com o ciclo de vida completo do desenvolvimento móvel.', items: ['Descreva como você configuraria um pipeline de CI/CD para um aplicativo móvel, incluindo testes e distribuição para beta testers.', 'Quais estratégias você usaria para automação de testes de UI?', 'Como você lida com o gerenciamento de diferentes ambientes (desenvolvimento, homologação, produção)?'] }
                        ]
                    },
                },
                'Full-Stack': {
                    'Geral': {
                        intro: 'A entrevista Full-Stack testa a amplitude e a capacidade de conectar o front-end e o back-end em um sistema coeso. A visão holística da aplicação é a chave.',
                        categories: [
                            { title: 'Comunicação Cliente-Servidor', goal: 'Avaliar o entendimento de como as partes da aplicação interagem.', items: ['Como o front-end se comunica com o back-end? (Vá além de "APIs REST")', 'Quais são as diferenças entre REST e GraphQL?', 'Explique o que são WebSockets e quando usá-los.', 'Descreva o fluxo de uma requisição HTTP, do navegador ao servidor e de volta.'] },
                            { title: 'Autenticação e Segurança', goal: 'Verificar o conhecimento sobre segurança em toda a stack.', items: ['Como você armazenaria a senha de um usuário de forma segura?', 'Descreva o fluxo de autenticação baseado em tokens (e.g., JWT).', 'O que é CORS e como você o configuraria no back-end?', 'Quais são os riscos de segurança mais comuns em aplicações web (OWASP Top 10)?'] },
                            { title: 'Design de Aplicação Holístico', goal: 'Avaliar a capacidade de tomar decisões arquiteturais para toda a stack.', items: ['Se você tivesse um mês para desenvolver um projeto do zero, quais tecnologias você usaria e por quê?', 'Como você estrutura um projeto full-stack (organização de pastas, etc.)?', 'Discuta os prós e contras de uma arquitetura monolítica vs. microsserviços para um novo projeto.'] },
                            { title: 'Performance e Escalabilidade', goal: 'Analisar a capacidade de pensar na performance de ponta a ponta.', items: ['Como você melhoraria uma página que está carregando lentamente? (Considere front e back)', 'Como você garante a escalabilidade de uma aplicação web?', 'O que é uma CDN e como ela ajuda na performance?', 'Descreva estratégias de caching no lado do cliente e do servidor.'] }
                        ]
                    }
                },
                'Design de Sistemas': {
                    'Geral': {
                        intro: 'A entrevista de Design de Sistemas é um teste colaborativo para avaliar a capacidade de projetar sistemas escaláveis, resilientes e manuteníveis. A comunicação e a análise de trade-offs são cruciais.',
                        categories: [
                            { title: 'Prompts Comuns', goal: 'Avaliar a habilidade de lidar com complexidade, ambiguidade e escala.', items: ['Projete o feed de notícias do Twitter/Facebook.', 'Projete um encurtador de URL como TinyURL.', 'Projete um serviço de streaming como Netflix/YouTube.', 'Projete um aplicativo de transporte como o Uber.', 'Projete um sistema de armazenamento de arquivos como o Google Drive.', 'Projete um sistema de chat como o WhatsApp.', 'Projete um sistema de busca de autocompletar.'] },
                            { title: 'Conceitos Essenciais', goal: 'Verificar a compreensão de fundamentos de sistemas distribuídos.', items: ['Escalabilidade (Horizontal vs. Vertical)', 'Balanceamento de Carga (Load Balancing)', 'Caching (Estratégias como Cache-aside)', 'Bancos de Dados (SQL vs. NoSQL)', 'Sharding de Banco de Dados', 'Replicação e Consistência de Dados', 'Teorema CAP', 'Comunicação Assíncrona (Filas de Mensagens)', 'Idempotência', 'Proxies e Gateways de API'] },
                            { title: 'Estrutura de Resposta', goal: 'Avaliar a abordagem metódica para resolver problemas abertos.', items: ['1. Esclarecer Requisitos (funcionais e não funcionais) e Suposições', '2. Fazer Estimativas (tráfego, armazenamento)', '3. Design de Alto Nível (Blueprint)', '4. Design da API', '5. Design do Banco de Dados (esquema)', '6. Aprofundamento (Deep Dive) em Componentes', '7. Identificar Gargalos e Escalar'] }
                        ]
                    }
                }
            }
        };

        let currentSeniority = 'Júnior';
        let currentStack = 'JavaScript/React';
        let seniorityChart;
        let audioContext;
        let currentAudio = null;

        const seniorityFiltersContainer = document.getElementById('seniority-filters');
        const stackFiltersContainer = document.getElementById('stack-filters');
        const questionsContainer = document.getElementById('questions-container');
        const questionsTitle = document.getElementById('questions-title');
        const questionsIntro = document.getElementById('questions-intro');
        const simulateInterviewBtn = document.getElementById('simulate-interview-btn');
        const modal = document.getElementById('modal');
        const modalTitle = document.getElementById('modal-title');
        const modalBody = document.getElementById('modal-body');
        const modalClose = document.getElementById('modal-close');


        // === OPENROUTER VIA BACKEND ===
        const OPENROUTER_MODEL = "openai/gpt-oss-20b:free";

        async function callOpenRouterAPI(prompt) {
            let response;
            let retries = 3;
            let delay = 1000;
            while (retries > 0) {
                try {
                    response = await fetch('/api/generate', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            model: OPENROUTER_MODEL,
                            messages: [
                                { role: "user", content: prompt }
                            ]
                        })
                    });
                    if (response.ok) {
                        const result = await response.json();
                        return result.choices?.[0]?.message?.content;
                    }
                } catch (error) {
                    console.error("API call failed, retrying...", error);
                }
                retries--;
                await new Promise(resolve => setTimeout(resolve, delay));
                delay *= 2;
            }
            throw new Error("API call failed after multiple retries.");
        }
        
        function showModal(title, content) {
            modalTitle.textContent = title;
            modalBody.innerHTML = content;
            modal.classList.add('visible');
        }

        function hideModal() {
            modal.classList.remove('visible');
        }
        
        function showLoader() {
            return '<div class="loader"></div><p class="text-center text-slate-500">Gerando com IA...</p>';
        }

        async function handleGenerateAnswer(question) {
            showModal('Resposta Modelo ✨', showLoader());
            try {
                const prompt = `Responda como um candidato ${currentSeniority} para ${currentStack}. Seja direto, objetivo e prático. Máximo 3-4 parágrafos. Pergunta: "${question}"`;
                const answer = await callOpenRouterAPI(prompt);
                const formattedAnswer = answer.replace(/\n/g, '<br>');
                modalBody.innerHTML = `<p>${formattedAnswer}</p>`;
            } catch (error) {
                modalBody.innerHTML = '<p class="text-red-500">Desculpe, ocorreu um erro ao gerar a resposta. Tente novamente.</p>';
                console.error(error);
            }
        }

        async function handleSimulateInterview() {
            const allQuestions = interviewData.questions[currentSeniority][currentStack].categories.flatMap(c => c.items);
            const question = allQuestions[Math.floor(Math.random() * allQuestions.length)];

            showModal('Simulação de Entrevista ✨', `
                <p class="font-semibold mb-2">Pergunta:</p>
                <p class="mb-4">${question}</p>
                <textarea id="user-answer" class="w-full p-2 border rounded-lg" rows="6" placeholder="Digite sua resposta aqui..."></textarea>
                <button id="submit-answer-btn" class="mt-4 bg-teal-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-teal-700 w-full">Enviar Resposta e Receber Feedback</button>
                <div id="feedback-container" class="mt-4"></div>
            `);

            document.getElementById('submit-answer-btn').addEventListener('click', async () => {
                const userAnswer = document.getElementById('user-answer').value;
                if (!userAnswer) return;

                const feedbackContainer = document.getElementById('feedback-container');
                feedbackContainer.innerHTML = showLoader();

                try {
                    const prompt = `Você é um recrutador tech avaliando um candidato ${currentSeniority}. Fale DIRETAMENTE com o candidato usando "você".

Pergunta: "${question}"
Resposta: "${userAnswer}"

Dê um feedback natural em 3 partes curtas:
1. Um elogio genuíno sobre a resposta
2. Uma observação crítica (se necessário para o nível)  
3. Uma dica prática para melhorar

Use linguagem natural, correta e direta. Máximo 3-4 linhas.`;
                    const feedback = await callOpenRouterAPI(prompt);
                    // Converter markdown para HTML de forma mais robusta
                    let formattedFeedback = feedback;
                    
                    // Converter **texto** para <strong>texto</strong>
                    formattedFeedback = formattedFeedback.replace(/\*\*([^*]+)\*\*/g, '<strong>$1</strong>');
                    
                    // Converter quebras de linha
                    formattedFeedback = formattedFeedback.replace(/\n/g, '<br>');
                    
                    feedbackContainer.innerHTML = `
                        <h4 class="font-bold text-lg mt-4">Feedback da IA:</h4>
                        <div class="p-4 bg-slate-100 rounded-lg mt-2">${formattedFeedback}</div>
                    `;
                } catch (error) {
                    feedbackContainer.innerHTML = '<p class="text-red-500">Desculpe, ocorreu um erro ao gerar o feedback. Tente novamente.</p>';
                    console.error(error);
                }
            });
        }

        function base64ToArrayBuffer(base64) {
            const binaryString = window.atob(base64);
            const len = binaryString.length;
            const bytes = new Uint8Array(len);
            for (let i = 0; i < len; i++) {
                bytes[i] = binaryString.charCodeAt(i);
            }
            return bytes.buffer;
        }
        
        function pcmToWav(pcmData, sampleRate) {
            const header = new ArrayBuffer(44);
            const view = new DataView(header);
            
            const writeString = (offset, string) => {
                for (let i = 0; i < string.length; i++) {
                    view.setUint8(offset + i, string.charCodeAt(i));
                }
            };

            const numChannels = 1;
            const bitsPerSample = 16;
            const blockAlign = numChannels * bitsPerSample / 8;
            const byteRate = sampleRate * blockAlign;
            const dataSize = pcmData.length * pcmData.BYTES_PER_ELEMENT;
            
            writeString(0, 'RIFF');
            view.setUint32(4, 36 + dataSize, true);
            writeString(8, 'WAVE');
            writeString(12, 'fmt ');
            view.setUint32(16, 16, true);
            view.setUint16(20, 1, true);
            view.setUint16(22, numChannels, true);
            view.setUint32(24, sampleRate, true);
            view.setUint32(28, byteRate, true);
            view.setUint16(32, blockAlign, true);
            view.setUint16(34, bitsPerSample, true);
            writeString(36, 'data');
            view.setUint32(40, dataSize, true);

            const wavBytes = new Uint8Array(44 + dataSize);
            wavBytes.set(new Uint8Array(header), 0);
            wavBytes.set(new Uint8Array(pcmData.buffer), 44);

            return new Blob([wavBytes], { type: 'audio/wav' });
        }

        // TTS removido: OpenRouter não suporta TTS gratuito neste modelo
        async function handlePlayAudio(text, button) {
            alert('Recurso de áudio não disponível neste modelo OpenRouter.');
        }

        function createFilterButtons(container, items, activeItem, clickHandler, type) {
            container.innerHTML = '';
            items.forEach(item => {
                const button = document.createElement('button');
                button.textContent = item;
                const baseClasses = 'px-4 py-2 rounded-full text-sm md:text-base font-semibold transition-all duration-300 ease-in-out focus:outline-none focus:ring-2 focus:ring-offset-2';
                if (type === 'seniority') {
                    button.className = `${baseClasses} bg-white text-teal-700 border border-teal-200 hover:bg-teal-50 focus:ring-teal-500`;
                } else {
                    button.className = `${baseClasses} bg-slate-100 text-slate-600 hover:bg-slate-200 focus:ring-slate-500`;
                }
                
                if (item === activeItem) {
                    button.classList.add(type === 'seniority' ? 'active-seniority' : 'active-stack');
                }
                button.addEventListener('click', () => clickHandler(item));
                container.appendChild(button);
            });
        }

        function handleSeniorityClick(seniority) {
            currentSeniority = seniority;
            if (!interviewData.questions[currentSeniority][currentStack]) {
                currentStack = Object.keys(interviewData.questions[currentSeniority])[0];
            }
            updateView();
        }

        function handleStackClick(stack) {
            currentStack = stack;
            updateView();
        }

        function updateView() {
            createFilterButtons(seniorityFiltersContainer, interviewData.seniorityLevels, currentSeniority, handleSeniorityClick, 'seniority');
            const availableStacks = Object.keys(interviewData.questions[currentSeniority]);
            createFilterButtons(stackFiltersContainer, availableStacks, currentStack, handleStackClick, 'stack');
            
            const data = interviewData.questions[currentSeniority][currentStack];
            
            questionsTitle.textContent = `${currentStack} - Nível ${currentSeniority}`;
            questionsIntro.textContent = data.intro;
            
            questionsContainer.innerHTML = '';
            if (data.categories) {
                data.categories.forEach(category => {
                    const card = document.createElement('div');
                    card.className = 'bg-white border border-slate-200 rounded-xl p-6 shadow-sm fade-in';
                    
                    const itemsHtml = category.items.map(item => `
                        <li class="flex items-start justify-between group py-1">
                            <div class="flex items-start">
                                <span class="text-teal-500 mr-3 mt-1">&#10003;</span>
                                <span>${item}</span>
                            </div>
                            <div class="flex items-center opacity-0 group-hover:opacity-100 transition-opacity shrink-0 ml-4">
                                <button class="tts-button p-1 rounded-full hover:bg-slate-200" title="Ouvir Pergunta">&#128266;</button>
                                <button class="generate-answer-btn ml-2 text-sm bg-teal-50 text-teal-700 px-2 py-1 rounded-md hover:bg-teal-100" title="Gerar Resposta Modelo">✨ Gerar</button>
                            </div>
                        </li>
                    `).join('');

                    card.innerHTML = `
                        <h4 class="font-bold text-lg text-slate-800 mb-2">${category.title}</h4>
                        <p class="text-sm text-slate-500 italic mb-4"><strong>Objetivo:</strong> ${category.goal}</p>
                        <ul class="space-y-2 text-slate-600">${itemsHtml}</ul>
                    `;
                    questionsContainer.appendChild(card);
                });
            }

            document.querySelectorAll('.generate-answer-btn').forEach((btn, index) => {
                const questionText = Array.from(btn.closest('li').querySelectorAll('span'))[1].textContent;
                btn.addEventListener('click', () => handleGenerateAnswer(questionText));
            });

            document.querySelectorAll('.tts-button').forEach((btn, index) => {
                const questionText = Array.from(btn.closest('li').querySelectorAll('span'))[1].textContent;
                btn.addEventListener('click', (e) => handlePlayAudio(questionText, e.currentTarget));
            });

            updateChart();
        }

        function updateChart() {
            const chartData = interviewData.chartData.datasets[currentSeniority];
            seniorityChart.data.datasets[0].data = chartData;
            seniorityChart.data.datasets[0].label = `Foco para ${currentSeniority}`;
            seniorityChart.update();
        }

        function initChart() {
            const ctx = document.getElementById('seniorityChart').getContext('2d');
            seniorityChart = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: interviewData.chartData.labels,
                    datasets: [{
                        label: 'Foco para Júnior',
                        data: interviewData.chartData.datasets['Júnior'],
                        backgroundColor: 'rgba(13, 148, 136, 0.2)',
                        borderColor: 'rgb(13, 148, 136)',
                        pointBackgroundColor: 'rgb(13, 148, 136)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgb(13, 148, 136)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: { color: 'rgba(0, 0, 0, 0.1)' },
                            grid: { color: 'rgba(0, 0, 0, 0.1)' },
                            pointLabels: { font: { size: 11, weight: '500' }, color: '#475569' },
                            ticks: { backdropColor: 'rgba(255, 255, 255, 0.75)', stepSize: 1, max: 5, min: 0 }
                        }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) label += ': ';
                                    if (context.parsed.r !== null) {
                                        const score = context.parsed.r;
                                        let level = '';
                                        if (score <= 1) level = 'Básico';
                                        else if (score <= 2) level = 'Importante';
                                        else if (score <= 3) level = 'Relevante';
                                        else if (score <= 4) level = 'Foco Principal';
                                        else level = 'Crucial';
                                        label += `${level} (Nível ${score})`;
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
        }

        document.addEventListener('DOMContentLoaded', () => {
            initChart();
            updateView();
            modalClose.addEventListener('click', hideModal);
            modal.addEventListener('click', (e) => {
                if (e.target === modal) hideModal();
            });
            simulateInterviewBtn.addEventListener('click', handleSimulateInterview);
        });
    </script>

</body>
</html>
